algorithm	:	GCNNEIGHBORGPU
vertices	:	232965
epochs		:	3
layers		:	602-128-41
fanout		:	10,25
val_fanout	:	10,25
batch_size	:	153431
val_batch_size	:	0
batch_type	:	shuffle
del_frac	:	0
dataset:	:	reddit
edge_file	:	../../data/reddit/reddit.edge
feature_file	:	../../data/reddit/reddit.feat
label_file	:	../../data/reddit/reddit.label
mask_file	:	../../data/reddit/reddit.mask
proc_overlap	:	0
proc_local	:	0
proc_cuda	:	0
proc_rep	:	0
lock_free	:	1
optim_kernel	:	0
learn_rate	:	0.001
weight_decay	:	0.0001
decay_rate	:	0.97
decay_epoch	:	100
drop_rate	:	0.5
classes		:	1
batch_norm	:	0
time_skip	:	3
runs		:	1
mini_pull	:	1
sample_rate	:	-1
run_time	:	5
batch_switch_time:	-1
batch_size_vec_string:	
sample_switch_time:	-1
sample_rate_vec_string:	
lower_fanout	:	0
cache_rate	:	0
cache_policy	:	degree
cache_type	:	gpu_memory
batch_switch_acc:	-1
pipelines	:	1
threads		:	-1
mode		:	zerocopy
best_parameter	:	0
threshold_trans	:	-1
cache_rate_start	:	0
cache_rate_end	:	0
cache_rate_num	:	0
trans_threshold_start	:	0
trans_threshold_end	:	0
trans_threshold_num	:	0
block_size	:	256
cache_exp	:	0
part_num	:	0
part_algo	:	
part_dim	:	0
target_degree	:	0
------------------input info--------------
NeutronStar::Preprocessing[Generate Full Replicated Graph Topo]
------------------finish graph preprocessing--------------

read_finish
2024-12-19 19:08:08 [GCN_GPU_NEIGHBOR.hpp:1333 :run] INFO  - GNNmini::[Dist.GPU.GCNimpl] running [3] Epoches

destrory_stream 0x61c7515d7480destory_Stream is done
set cuda_steram 0x61c7515d7480 to 0x61c7b20a69b0
set cuda_steram 0x61c7b20a69b0 to 0x61c7b20a69b0
2024-12-19 19:08:08 [ntsSampler.hpp:261 :update_batch_size] DEBUG - batch_size switch to 153431
train sampler 25, 10, 
2024-12-19 19:08:08 [ntsSampler.hpp:261 :update_batch_size] DEBUG - batch_size switch to 153431
2024-12-19 19:08:08 [ntsSampler.hpp:261 :update_batch_size] DEBUG - batch_size switch to 23831
val sampler 25, 10, 
val subgraph sampler 25, 10, 
2024-12-19 19:08:08 [ntsSampler.hpp:261 :update_batch_size] DEBUG - batch_size switch to 153431
test sampler 25, 10, 
test subgraph sampler 25, 10, 
2024-12-19 19:08:08 [GCN_GPU_NEIGHBOR.hpp:1415 :run] INFO  - label rate: 1.000, train/val/test: (153431/23831/55703) (0.659/0.102/0.239)
2024-12-19 19:08:08 [GCN_GPU_NEIGHBOR.hpp:1423 :run] DEBUG - iterations 2147483647 config_run_time 5.000
2024-12-19 19:08:08 [GCN_GPU_NEIGHBOR.hpp:1430 :run] DEBUG - start get_gpu_idle_mem_pipe()
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:1200 :get_gpu_idle_mem_pipe] DEBUG - get_gpu_idle_mem_pipe(): epoch 0 used 3857.000 max_used 3857.000 total 81050.625
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:1432 :run] DEBUG - release gpu memory
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:1435 :run] DEBUG - used 2789.000 total 81050.625 (after emptyCache)
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:1217 :determine_cache_node_idx] DEBUG - cache_node_num 232965 (1.000)
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:1236 :determine_cache_node_idx] DEBUG - cache_high_degree
2024-12-19 19:08:09 [GCN_GPU_NEIGHBOR.hpp:945 :mark_cache_node] DEBUG - cache_node_num 232965 tmp_idx 232965
2024-12-19 19:08:10 [GCN_GPU_NEIGHBOR.hpp:922 :gater_cpu_cache_feature_and_trans_to_gpu] DEBUG - start trans to gpu
2024-12-19 19:08:10 [GCN_GPU_NEIGHBOR.hpp:1441 :run] DEBUG - used 3325.000 total 81050.625 (after cache feature)
2024-12-19 19:08:10 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:10 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 000 train_loss 3.740 train_acc 0.021 val_loss 3.399 val_acc 0.152 test_acc 0.146 train_time 0.402(sample 0.148 trans 0.015 graph 0.199 nn 0.001) val_time 0.197, gcn_run_time 0.402) batch_size (153431, 23831)
2024-12-19 19:08:10 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:11 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 001 train_loss 3.475 train_acc 0.146 val_loss 3.152 val_acc 0.250 test_acc 0.244 train_time 0.373(sample 0.108 trans 0.015 graph 0.211 nn 0.000) val_time 0.178, gcn_run_time 0.775) batch_size (153431, 23831)
2024-12-19 19:08:11 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:12 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 002 train_loss 3.295 train_acc 0.216 val_loss 2.945 val_acc 0.367 test_acc 0.363 train_time 0.336(sample 0.083 trans 0.014 graph 0.200 nn 0.000) val_time 0.172, gcn_run_time 1.112) batch_size (153431, 23831)
2024-12-19 19:08:12 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:13 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 003 train_loss 3.177 train_acc 0.303 val_loss 2.753 val_acc 0.395 test_acc 0.395 train_time 0.346(sample 0.082 trans 0.015 graph 0.211 nn 0.000) val_time 0.175, gcn_run_time 1.458) batch_size (153431, 23831)
2024-12-19 19:08:13 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:14 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 004 train_loss 3.069 train_acc 0.359 val_loss 2.585 val_acc 0.409 test_acc 0.410 train_time 0.334(sample 0.081 trans 0.015 graph 0.199 nn 0.000) val_time 0.178, gcn_run_time 1.792) batch_size (153431, 23831)
2024-12-19 19:08:14 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:14 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 005 train_loss 2.966 train_acc 0.385 val_loss 2.435 val_acc 0.417 test_acc 0.417 train_time 0.334(sample 0.082 trans 0.017 graph 0.196 nn 0.000) val_time 0.173, gcn_run_time 2.126) batch_size (153431, 23831)
2024-12-19 19:08:14 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:15 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 006 train_loss 2.872 train_acc 0.400 val_loss 2.309 val_acc 0.420 test_acc 0.421 train_time 0.335(sample 0.082 trans 0.015 graph 0.201 nn 0.000) val_time 0.178, gcn_run_time 2.461) batch_size (153431, 23831)
2024-12-19 19:08:15 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:16 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 007 train_loss 2.776 train_acc 0.409 val_loss 2.202 val_acc 0.426 test_acc 0.429 train_time 0.333(sample 0.082 trans 0.015 graph 0.198 nn 0.000) val_time 0.174, gcn_run_time 2.794) batch_size (153431, 23831)
2024-12-19 19:08:16 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:17 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 008 train_loss 2.689 train_acc 0.418 val_loss 2.113 val_acc 0.436 test_acc 0.437 train_time 0.331(sample 0.083 trans 0.015 graph 0.195 nn 0.000) val_time 0.167, gcn_run_time 3.125) batch_size (153431, 23831)
2024-12-19 19:08:17 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:17 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 009 train_loss 2.603 train_acc 0.425 val_loss 2.043 val_acc 0.447 test_acc 0.448 train_time 0.329(sample 0.082 trans 0.014 graph 0.193 nn 0.000) val_time 0.173, gcn_run_time 3.454) batch_size (153431, 23831)
2024-12-19 19:08:17 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:18 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 010 train_loss 2.519 train_acc 0.435 val_loss 1.991 val_acc 0.458 test_acc 0.460 train_time 0.335(sample 0.082 trans 0.015 graph 0.200 nn 0.000) val_time 0.177, gcn_run_time 3.789) batch_size (153431, 23831)
2024-12-19 19:08:18 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:19 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 011 train_loss 2.441 train_acc 0.448 val_loss 1.958 val_acc 0.470 test_acc 0.471 train_time 0.326(sample 0.080 trans 0.015 graph 0.194 nn 0.000) val_time 0.174, gcn_run_time 4.115) batch_size (153431, 23831)
2024-12-19 19:08:19 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:20 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 012 train_loss 2.364 train_acc 0.459 val_loss 1.928 val_acc 0.485 test_acc 0.486 train_time 0.332(sample 0.083 trans 0.015 graph 0.197 nn 0.000) val_time 0.177, gcn_run_time 4.448) batch_size (153431, 23831)
2024-12-19 19:08:20 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:20 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 013 train_loss 2.295 train_acc 0.469 val_loss 1.910 val_acc 0.500 test_acc 0.497 train_time 0.333(sample 0.082 trans 0.015 graph 0.198 nn 0.000) val_time 0.175, gcn_run_time 4.780) batch_size (153431, 23831)
2024-12-19 19:08:20 [GCN_GPU_NEIGHBOR.hpp:774 :Forward] DEBUG - zerocopy version
2024-12-19 19:08:21 [GCN_GPU_NEIGHBOR.hpp:1505 :run] INFO  - Epoch 014 train_loss 2.225 train_acc 0.483 val_loss 1.895 val_acc 0.510 test_acc 0.510 train_time 0.340(sample 0.084 trans 0.014 graph 0.205 nn 0.000) val_time 0.186, gcn_run_time 5.120) batch_size (153431, 23831)

main(): Best-val-acc: 0.510428 
Val-mean-var 1 runs: 0.5104(0.0000)
edge_file: ../../data/reddit/reddit.edge
exec_time=52.418598(s)
